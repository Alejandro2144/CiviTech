#  Base image 
FROM python:3.11-slim

#  Directorio de trabajo 
WORKDIR /app
ENV PYTHONUNBUFFERED=1

#  Instalaci贸n de dependencias 
COPY requirements.txt .
RUN pip install --upgrade pip \
 && pip install --no-cache-dir -r requirements.txt

#  C贸digo de la aplicaci贸n 
COPY . .

#  Puerto configurable 
ARG PORT=8002             #  C谩mbialo si Documentos corre en otro puerto
ENV PORT=${PORT}
EXPOSE ${PORT}

#  Variables externas 
#  Si tu servicio de Ciudadanos no est谩 en localhost:8001, ajusta esta URL
ENV CITIZEN_MS_URL=http://localhost:8001
#  Ajusta RABBIT_URL y MINIO_ENDPOINT seg煤n tus entornos locales o Kubernetes
ENV RABBIT_URL=amqp://localhost
ENV MINIO_ENDPOINT=http://localhost:9000

#  Inicio de la aplicaci贸n 
ENTRYPOINT ["sh","-c"]
CMD ["uvicorn main:app --host 0.0.0.0 --port $PORT"]

